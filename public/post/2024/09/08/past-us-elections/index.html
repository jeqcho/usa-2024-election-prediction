<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Past US Elections | A minimal Hugo website</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Past US Elections</span></h1>
<h2 class="author">Je Qin Chooi</h2>
<h2 class="date">2024/09/08</h2>
</div>

<main>
<pre><code class="language-r"># Load libraries.
## install via `install.packages(&quot;name&quot;)`
library(ggplot2)
library(maps)
library(tidyverse)
</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ lubridate 1.9.3     ✔ tibble    3.2.1
## ✔ purrr     1.0.2     ✔ tidyr     1.3.1
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ✖ purrr::map()    masks maps::map()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
</code></pre>
<pre><code class="language-r"># Read presidential popular vote. 
d_popvote &lt;- read_csv(&quot;data/popvote_1948-2020.csv&quot;)
</code></pre>
<pre><code>## Rows: 38 Columns: 9
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (2): party, candidate
## dbl (3): year, pv, pv2p
## lgl (4): winner, incumbent, incumbent_party, prev_admin
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
<pre><code class="language-r">d_popvote |&gt;
  ggplot(aes(x = year, y = pv2p, fill = party)) +
  geom_bar(stat = &quot;identity&quot;) +
  geom_hline(yintercept = 50, linetype=&quot;dashed&quot;, color=&quot;black&quot;) +
  geom_hline(yintercept = 45, linetype=&quot;dashed&quot;, color=&quot;black&quot;) +
  geom_hline(yintercept = 55, linetype=&quot;dashed&quot;, color=&quot;black&quot;) +
  scale_fill_manual(values = c(&quot;dodgerblue4&quot;, &quot;firebrick1&quot;)) +
  labs(y=&quot;Two-party vote share&quot;,
       x=&quot;Year&quot;,
       fill=&quot;Party&quot;,
       title=&quot;Two-party vote share over time&quot;) +
  theme_bw()
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-3-1.png" width="672" />
<pre><code class="language-r"># Read wide version of dataset that can be used to compare candidate votes with one another. 
d_pvstate_wide &lt;- read_csv(&quot;data/clean_wide_state_2pv_1948_2020.csv&quot;)
</code></pre>
<pre><code>## Rows: 959 Columns: 15
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): state, region
## dbl (13): year, D_pv, R_pv, D_pv2p, R_pv2p, D_pv_lag1, R_pv_lag1, D_pv2p_lag...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
<pre><code class="language-r"># Merge d_pvstate_wide with state_map.
d_pvstate_wide$region &lt;- tolower(d_pvstate_wide$state)

ec &lt;- read_csv(&quot;data/ec_full.csv&quot;)
</code></pre>
<pre><code>## Rows: 936 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): state
## dbl (2): electors, year
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
<pre><code class="language-r"># no data for 1960
pv2p_states &lt;- d_pvstate_wide |&gt; 
  left_join(ec, by = c(&quot;state&quot;, &quot;year&quot;)) |&gt;
  filter(year&gt;=min(ec$year)) |&gt;
  mutate(d_win=D_pv&gt;R_pv) |&gt;
  mutate(d_evotes=d_win*electors) |&gt;
  group_by(year)|&gt;
  summarize(d_total_evotes=sum(d_evotes))

d_pvstate_wide |&gt; 
  left_join(ec, by = c(&quot;state&quot;, &quot;year&quot;)) |&gt;
  filter(year==1960) |&gt;
  select(electors)
</code></pre>
<pre><code>## # A tibble: 50 × 1
##    electors
##       &lt;dbl&gt;
##  1       NA
##  2       NA
##  3       NA
##  4       NA
##  5       NA
##  6       NA
##  7       NA
##  8       NA
##  9       NA
## 10       NA
## # ℹ 40 more rows
</code></pre>
<pre><code class="language-r"># no data for 1960
ec |&gt;
  filter(year==1960)
</code></pre>
<pre><code>## # A tibble: 0 × 3
## # ℹ 3 variables: state &lt;chr&gt;, electors &lt;dbl&gt;, year &lt;dbl&gt;
</code></pre>
<pre><code class="language-r">(ec |&gt;
  filter(year==2016) |&gt;
  select(state,electors) |&gt;
  mutate(electors=ifelse(is.na(electors),0,electors)) )$electors
</code></pre>
<pre><code>##  [1]  11   3   4   8  32   6   8   0   3  10  12   3   4  27  13  10   8  10  10
## [20]   5   9  16  20  11   8  13   4   6   3   4  16   4  45  14   4  25   8   6
## [39]  32   4   8   4  11  24 444   4   3  12   9   8  12   3
</code></pre>
<pre><code class="language-r">a &lt;- (ec |&gt;
  filter(year==2008) |&gt;
  select(state,electors) )
a[order(a$electors,decreasing=TRUE),]
</code></pre>
<pre><code>## # A tibble: 52 × 2
##    state        electors
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 Total             447
##  2 New York           43
##  3 California         40
##  4 Pennsylvania       29
##  5 Illinois           26
##  6 Ohio               26
##  7 Texas              25
##  8 Michigan           21
##  9 New Jersey         17
## 10 Florida            14
## # ℹ 42 more rows
</code></pre>
<pre><code class="language-r"># 2008 cal has 40
a &lt;- (ec |&gt;
  filter(year==2016) |&gt;
  select(state,electors) )
a[order(a$electors,decreasing=TRUE),]
</code></pre>
<pre><code>## # A tibble: 52 × 2
##    state         electors
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 Total              444
##  2 New York            45
##  3 California          32
##  4 Pennsylvania        32
##  5 Illinois            27
##  6 Ohio                25
##  7 Texas               24
##  8 Michigan            20
##  9 Massachusetts       16
## 10 New Jersey          16
## # ℹ 42 more rows
</code></pre>
<pre><code class="language-r"># 2016 cal has 32

a &lt;- (ec |&gt;
  filter(year==2020) |&gt;
  select(state,electors) )
a[order(a$electors,decreasing=TRUE),]
</code></pre>
<pre><code>## # A tibble: 52 × 2
##    state         electors
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 Total              444
##  2 New York            45
##  3 California          32
##  4 Pennsylvania        32
##  5 Illinois            27
##  6 Ohio                25
##  7 Texas               24
##  8 Michigan            20
##  9 Massachusetts       16
## 10 New Jersey          16
## # ℹ 42 more rows
</code></pre>
<pre><code class="language-r"># 2016 cal has 32
</code></pre>
<p>Make maps</p>
<pre><code class="language-r">states_map &lt;- map_data(&quot;state&quot;)

d_pvstate_wide &lt;- read_csv(&quot;data/clean_wide_state_2pv_1948_2020.csv&quot;)
</code></pre>
<pre><code>## Rows: 959 Columns: 15
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): state, region
## dbl (13): year, D_pv, R_pv, D_pv2p, R_pv2p, D_pv_lag1, R_pv_lag1, D_pv2p_lag...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
<pre><code class="language-r">d_pvstate_wide$region &lt;- tolower(d_pvstate_wide$state)

d_pvstate_wide$vote_bucket = cut(
  d_pvstate_wide$D_pv2p,
  breaks = seq(0,100,10),
  labels = c(
    &quot;0-10%&quot;,
    &quot;10-20%&quot;,
    &quot;20-30%&quot;,
    &quot;30-40%&quot;,
    &quot;40-50%&quot;,
    &quot;50-60%&quot;,
    &quot;60-70%&quot;,
    &quot;70-80%&quot;,
    &quot;80-90%&quot;,
    &quot;90-100%&quot;
  )
)

d_pvstate_wide |&gt;
    filter(year &gt;= 2012) |&gt;
    left_join(states_map, by = &quot;region&quot;) |&gt;
    ggplot(aes(long, lat, group = group)) +
    facet_wrap(facets = year ~.) + ## specify a grid by year
    geom_polygon(aes(fill = vote_bucket), color = &quot;white&quot;) +
    scale_fill_manual(values = c(
        &quot;0-10%&quot; = &quot;#67000d&quot;,   # Dark red
        &quot;10-20%&quot; = &quot;#a50f15&quot;,
        &quot;20-30%&quot; = &quot;#cb181d&quot;,
        &quot;30-40%&quot; = &quot;#ef3b2c&quot;,
        &quot;40-50%&quot; = &quot;#fb6a4a&quot;,
        &quot;50-60%&quot; = &quot;#6baed6&quot;,  # Light blue
        &quot;60-70%&quot; = &quot;#4292c6&quot;,
        &quot;70-80%&quot; = &quot;#2171b5&quot;,
        &quot;80-90%&quot; = &quot;#08519c&quot;,
        &quot;90-100%&quot; = &quot;#08306b&quot;  # Dark blue
    ))+
  labs(fill=&quot;Democratic two-party \nvote share&quot;)+
    theme_void() +
    ggtitle(&quot;Presidential Vote Share by State (1980-2020)&quot;) + 
    theme(legend.text = element_text(size = 6),  # Smaller legend text
        legend.title = element_text(size = 8),  # Smaller legend title
          legend.position = &quot;bottom&quot;,
        aspect.ratio=0.7)
</code></pre>
<pre><code>## Warning in left_join(filter(d_pvstate_wide, year &gt;= 2012), states_map, by = &quot;region&quot;): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 1 of `x` matches multiple rows in `y`.
## ℹ Row 1 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship =
##   &quot;many-to-many&quot;` to silence this warning.
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-5-1.png" width="672" />
<pre><code class="language-r">std_vote_share &lt;- d_pvstate_wide |&gt;
  filter(year&gt;=1980)|&gt;
  group_by(region) |&gt;
  summarize(std=sd(D_pv2p))

pv_map &lt;- std_vote_share|&gt;
  left_join(states_map, by = &quot;region&quot;)

library(viridis)
</code></pre>
<pre><code>## Loading required package: viridisLite
</code></pre>
<pre><code>## 
## Attaching package: 'viridis'
</code></pre>
<pre><code>## The following object is masked from 'package:maps':
## 
##     unemp
</code></pre>
<pre><code class="language-r"># Generate map of two-party vote share for Republican candidates. 
pv_map |&gt; # N.B. You can pipe (|&gt;) data directly into `ggplot()`!
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = std), color = &quot;white&quot;)+
  scale_fill_viridis() +
  theme_void()
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-6-1.png" width="672" />
<pre><code class="language-r">std_vote_share &lt;- d_pvstate_wide |&gt;
  filter(year&gt;=2000)|&gt;
  group_by(region) |&gt;
  summarize(std=sd(D_pv2p))

pv_map &lt;- std_vote_share|&gt;
  left_join(states_map, by = &quot;region&quot;)

# Generate map of two-party vote share for Republican candidates. 
pv_map |&gt; # N.B. You can pipe (|&gt;) data directly into `ggplot()`!
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = std), color = &quot;white&quot;)+
  scale_fill_viridis() +
  theme_void()
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-7-1.png" width="672" />
<pre><code class="language-r">std_vote_share &lt;- d_pvstate_wide |&gt;
  filter(year&gt;=2012)|&gt;
  group_by(region) |&gt;
  summarize(std=sd(D_pv2p))

pv_map &lt;- std_vote_share|&gt;
  left_join(states_map, by = &quot;region&quot;)

# Generate map of two-party vote share for Republican candidates. 
pv_map |&gt; # N.B. You can pipe (|&gt;) data directly into `ggplot()`!
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = std), color = &quot;white&quot;)+
  scale_fill_viridis() +
  theme_void()
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-8-1.png" width="672" />
<pre><code class="language-r">states_map &lt;- map_data(&quot;state&quot;)

d_pvstate_wide &lt;- read_csv(&quot;data/clean_wide_state_2pv_1948_2020.csv&quot;)
</code></pre>
<pre><code>## Rows: 959 Columns: 15
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): state, region
## dbl (13): year, D_pv, R_pv, D_pv2p, R_pv2p, D_pv_lag1, R_pv_lag1, D_pv2p_lag...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
<pre><code class="language-r">d_pvstate_wide$region &lt;- tolower(d_pvstate_wide$state)

prev_years &lt;- data.frame(
  prev_years=d_pvstate_wide$year,
  prev_D_pv2p=d_pvstate_wide$D_pv2p,
  region=d_pvstate_wide$region
)

d_pvstate_wide$prev_years &lt;- d_pvstate_wide$year - 4
d_pvstate_wide &lt;- d_pvstate_wide |&gt;
  left_join(prev_years, by=c(&quot;region&quot;,&quot;prev_years&quot;))
d_pvstate_wide$delta &lt;- d_pvstate_wide$D_pv2p - d_pvstate_wide$prev_D_pv2p

d_pvstate_wide$delta_bucket = cut(
  d_pvstate_wide$delta,
  breaks = seq(-50,50,10),
  labels = c(
    &quot;-50 to -40%&quot;,
    &quot;-40 to -30%&quot;,
    &quot;-30 to -20%&quot;,
    &quot;-20 to -10%&quot;,
    &quot;-10 to 0%&quot;,
    &quot;+0 to 10%&quot;,
    &quot;+10 to 20%&quot;,
    &quot;+20 to 30%&quot;,
    &quot;+30 to 40%&quot;,
    &quot;+40 to 50%&quot;
  )
)


d_pvstate_wide |&gt;
  filter(year &gt;= 2000) |&gt;
  left_join(states_map, by = &quot;region&quot;) |&gt;
  ggplot(aes(long, lat, group = group)) +
  facet_wrap(facets = year ~ .) + ## specify a grid by year
  geom_polygon(aes(fill = delta_bucket), color = &quot;white&quot;) +
  scale_fill_manual(
    values = c(
      &quot;-50 to -40%&quot; = &quot;#67000d&quot;,
      # Dark red
      &quot;-40 to -30%&quot; = &quot;#a50f15&quot;,
      &quot;-30 to -20%&quot; = &quot;#cb181d&quot;,
      &quot;-20 to -10%&quot; = &quot;#ef3b2c&quot;,
      &quot;-10 to 0%&quot;  = &quot;#fb6a4a&quot;,
      &quot;+0 to 10%&quot;  = &quot;#6baed6&quot;,
      # Light blue
      &quot;+10 to 20%&quot; = &quot;#4292c6&quot;,
      &quot;+20 to 30%&quot; = &quot;#2171b5&quot;,
      &quot;+30 to 40%&quot; = &quot;#08519c&quot;,
      &quot;+40 to 50%&quot; = &quot;#08306b&quot;  # Dark blue
    )
  ) +
  labs(fill = &quot;Democratic two-party \nvote share change&quot;) +
  theme_void() +
  ggtitle(&quot;Presidential Vote Share Changes by State (1980-2020)&quot;) +
  theme(
    legend.text = element_text(size = 6),
    # Smaller legend text
    legend.title = element_text(size = 8),
    # Smaller legend title
    legend.position = &quot;bottom&quot;,
    aspect.ratio = 0.7
  )
</code></pre>
<pre><code>## Warning in left_join(filter(d_pvstate_wide, year &gt;= 2000), states_map, by = &quot;region&quot;): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 1 of `x` matches multiple rows in `y`.
## ℹ Row 1 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship =
##   &quot;many-to-many&quot;` to silence this warning.
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-9-1.png" width="672" />
<p>Swing states</p>
<pre><code class="language-r">swing &lt;- std_vote_share|&gt;
  left_join(d_pvstate_wide, by=&quot;region&quot;) |&gt;
  filter(year==&quot;2020&quot;) |&gt;
  mutate(min_share=pmin(D_pv2p,R_pv2p))|&gt;
  mutate(best_share=pmin(D_pv2p,R_pv2p)+std)|&gt;
  mutate(swing=ifelse(pmin(D_pv2p,R_pv2p)+std&gt;50,1,0))
swing$swing
</code></pre>
<pre><code>##  [1] 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0
## [39] 1 0 0 0 0 0 0 0 0 0 0 1 0
</code></pre>
<pre><code class="language-r">swing|&gt;
  select(D_pv2p,R_pv2p,std,swing,min_share)
</code></pre>
<pre><code>## # A tibble: 51 × 5
##    D_pv2p R_pv2p   std swing min_share
##     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1   37.1  62.9   1.58     0     37.1 
##  2   44.7  55.3   1.59     0     44.7 
##  3   50.2  49.8   2.39     1     49.8 
##  4   35.8  64.2   1.21     0     35.8 
##  5   64.9  35.1   2.19     0     35.1 
##  6   56.9  43.1   2.44     0     43.1 
##  7   60.2  39.8   1.53     0     39.8 
##  8   59.6  40.4   2.04     0     40.4 
##  9   94.5   5.53  1.57     0      5.53
## 10   48.3  51.7   1.07     0     48.3 
## # ℹ 41 more rows
</code></pre>
<pre><code class="language-r">(swing|&gt;subset(swing==1))$region
</code></pre>
<pre><code>## [1] &quot;arizona&quot;      &quot;georgia&quot;      &quot;iowa&quot;         &quot;michigan&quot;     &quot;nevada&quot;      
## [6] &quot;pennsylvania&quot; &quot;wisconsin&quot;
</code></pre>
<pre><code class="language-r">A &lt;- swing|&gt;select(-min_share)
B &lt;- swing|&gt;select(-std)
B$value &lt;- B$min_share
B$is_min_share &lt;- &quot;Vote share of losing party in 2020&quot;
A$value &lt;- A$std
A$is_min_share &lt;- &quot;Standard deviation&quot;
A &lt;- A|&gt;select(-std)
B &lt;- B|&gt;select(-min_share)
C &lt;- rbind(A, B)
C$rank &lt;- rank(-C$best_share, ties=&quot;first&quot;)

# install.packages(&quot;ggtext&quot;)
library(ggtext)

factor_vector &lt;- c(rep(1, 7), rep(0, 44))

ggplot(C, aes(
  fill = is_min_share,
  y = value,
  x = reorder(region, -best_share)
)) +
  geom_bar(position =position_stack((reverse=TRUE)), stat = &quot;identity&quot;) +
  geom_hline(yintercept = 50, linetype=&quot;dashed&quot;, size=0.3) +
  labs(x=&quot;State&quot;, y=&quot;Vote share&quot;,fill=&quot;Vote share&quot;) +
  theme(legend.position = &quot;bottom&quot;) +
  theme(axis.text.x = ggtext::element_markdown(  # Use markdown text
      size = 7, angle = 45, hjust = 1, 
      colour = ifelse(factor_vector, &quot;red&quot;, &quot;black&quot;)
    ))
</code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
</code></pre>
<img src="/post/2024/09/08/past-us-elections/index_files/figure-html/unnamed-chunk-10-1.png" width="672" />

</main>

  <footer>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="//cdn.jsdelivr.net/combine/npm/katex/dist/katex.min.js,npm/katex/dist/contrib/auto-render.min.js,npm/@xiee/utils/js/render-katex.js" defer></script>

<script src="//cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.min.js" defer></script>

  
  <hr/>
  © <a href="https://yihui.org">Yihui Xie</a> 2017 &ndash; 2024 | <a href="https://github.com/yihui">Github</a> | <a href="https://twitter.com/xieyihui">Twitter</a>
  
  </footer>
  </body>
</html>

